- name: 🚀 Start Ngrok Tunnel for RDP (3389)
  run: |
    Start-Process -FilePath "./ngrok/ngrok.exe" -ArgumentList "tcp 3389" -RedirectStandardOutput "D:\a\ngrok.log"
    Start-Sleep -Seconds 15

- name: 🌐 Show Public RDP Address
  run: |
    $log = Get-Content "D:\a\ngrok.log" -Raw
    if ($log -match "url=tcp://([a-zA-Z0-9\.-]+):([0-9]+)") {
      $host = $matches[1]
      $port = $matches[2]
      Write-Output "`n🔗 RDP Login Address: ${host}:${port}`n"
    } else {
      Write-Output "❌ Could not extract Ngrok tunnel URL. Dumping log:"
      Write-Output "`n--- NGROK LOG START ---`n"
      Get-Content "D:\a\ngrok.log"
      Write-Output "`n--- NGROK LOG END ---`n"
    }
